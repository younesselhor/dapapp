import{d as u}from"./chunk-YIROKGJS.js";import{P as n,T as l,Y as h,k as a,o as e,z as r}from"./chunk-L23ZLJ25.js";var m=class o{constructor(t){this.http=t}apiUrl="https://be.dabapp.co/api/";wishlistSubject=new a([]);wishlist$=this.wishlistSubject.asObservable();getListing(t){return this.http.get(`${this.apiUrl}listings/${t}`)}getDraftListings(){return this.http.get(this.apiUrl+"listings/draft")}getSingleDraft(t){return this.http.get(this.apiUrl+`listings/draft/${t}`)}submitSoom(t,s){let i=`${this.apiUrl}listings/${t}/soom`,b={amount:s};return this.http.post(i,b)}lastSoom(t){return this.http.get(this.apiUrl+"listings/"+t+"/last-soom")}getWishlists(){return this.http.get(this.apiUrl+"wishlists").pipe(n(t=>{let s=t.data.map(i=>i.listing_id);this.wishlistSubject.next(s)}),r(t=>(console.error("Error fetching wishlists",t),e(()=>new Error("Failed to fetch wishlists")))))}getWishlistById(t){return this.http.get(`${this.apiUrl}wishlists/${t}`).pipe(r(s=>(console.error("Error fetching wishlist",s),e(()=>new Error("Failed to fetch wishlist")))))}addToWishlist(t){return this.http.post(this.apiUrl+"wishlists",{listing_id:t}).pipe(n(()=>{let s=this.wishlistSubject.value;this.wishlistSubject.next([...s,t])}),r(s=>(console.error("Error adding to wishlist",s),e(()=>new Error("Failed to add to wishlist")))))}removeFromWishlist(t){return this.http.delete(`${this.apiUrl}wishlists/${t}`).pipe(n(()=>{let s=this.wishlistSubject.value;this.wishlistSubject.next(s.filter(i=>i!==t))}),r(s=>(console.error("Error removing from wishlist",s),e(()=>new Error("Failed to remove from wishlist")))))}updateWishlist(t,s){return this.http.put(`${this.apiUrl}wishlists/${t}`,s).pipe(r(i=>(console.error("Error updating wishlist",i),e(()=>new Error("Failed to update wishlist")))))}toggleWishlist(t,s){return s?this.removeFromWishlist(t):this.addToWishlist(t)}isInWishlist(t){return this.wishlistSubject.value.includes(t)}loadWishlistIds(){this.getWishlists().subscribe({next:()=>console.log("Wishlist loaded"),error:t=>console.error("Error loading wishlist",t)})}static \u0275fac=function(s){return new(s||o)(h(u))};static \u0275prov=l({token:o,factory:o.\u0275fac,providedIn:"root"})};export{m as a};
