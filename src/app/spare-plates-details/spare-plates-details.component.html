<div class="main-container">
  <div class="content-container">
    <!-- <app-sidebar></app-sidebar> -->
    <!-- Side Bar Start -->

    <div class="sidebar" style="width: 25%;">
      <h2>FILTERS</h2>

    <div class="filter-section">
  <div class="filter-header" (click)="toggleDigits()">
    <span class="filter-title">Condition</span>
    <span class="toggle-icon">{{ isDigitsOpen ? '−' : '+' }}</span>
  </div>

  <div class="filter-content" *ngIf="isDigitsOpen">
    <div class="checkbox-item">
      <input  class="condition-checkbox" type="checkbox" id="condition-all" name="condition" [checked]="!selectedCondition"
        (change)="selectedCondition = ''; executeFilter()">
      <label for="condition-all">All Conditions</label>
    </div>
    <div class="checkbox-item">
      <input class="condition-checkbox" type="checkbox" id="condition-new" name="condition" value="new" [checked]="selectedCondition === 'new'"
        (change)="selectedCondition = 'new'; executeFilter()">
      <label for="condition-new">New</label>
    </div>
    <div class="checkbox-item">
      <input class="condition-checkbox" type="checkbox" id="condition-used" name="condition" value="used"
        [checked]="selectedCondition === 'used'" (change)="selectedCondition = 'used'; executeFilter()">
      <label for="condition-used">Used</label>
    </div>
  </div>
</div>



<!-- Brand Filter Section -->
<div class="filter-section">
  <div class="filter-header" (click)="toggleCountry()">
     <span class="filter-title">Brand</span>
    <span class="toggle-icon">{{ isCountryOpen ? '−' : '+' }}</span>
  </div>

  <div class="filter-content" *ngIf="isCountryOpen">
    <!-- Brand search input -->
   <div class="search-box">
  <input type="text" placeholder="Search brands..." [(ngModel)]="searchBrandTerm" 
         (input)="displayCount = 6; applyFilters()">
  <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 30 30" fill="none">
    <path d="M25.8648 23.122L20.4231 17.6803C21.2439 16.3339 21.7162 14.7499 21.7162 13.0579C21.7162 8.1374 17.4523 3.875 12.5319 3.875C7.61138 3.875 3.62402 7.86236 3.62402 12.7828C3.62402 17.7019 7.88786 21.9657 12.8069 21.9657C14.4442 21.9657 15.9749 21.5208 17.2925 20.7504L22.7631 26.2238C23.2987 26.758 24.1671 26.758 24.7013 26.2238L26.0592 24.8659C26.5935 24.3316 26.3991 23.6563 25.8648 23.122ZM6.36578 12.7828C6.36578 9.3758 9.12626 6.61532 12.5319 6.61532C15.9375 6.61532 18.9744 9.6494 18.9744 13.0579C18.9744 16.4635 16.2125 19.2254 12.8069 19.2254C9.4013 19.2254 6.36578 16.1884 6.36578 12.7828Z" fill="#FA4C06"/>
  </svg>
</div>

    <!-- Brand list with scroll -->
    <div class="scrollable-list">
      <div class="checkbox-item" *ngFor="let brand of filteredBrands">
        <input  class="condition-checkbox" type="checkbox" [id]="'brand-' + brand.id" [checked]="brand.checked"
               (change)="brand.checked = !brand.checked;  onBrandChangecheck()">
        <label [for]="'brand-' + brand.id">
          {{ brand.name }} <span class="count">({{ brand.listings_count}})</span>
        </label>
      </div>
    </div>

    <!-- Show more button -->
    <button class="show-more-btn" *ngIf="bikePartsBrand.length > displayCount" 
            (click)="showMoreBrands()">
      Show More Brands
    </button>
  </div>
</div>

<!-- Category Filter Section -->
<div class="filter-section">
  <div class="filter-header" (click)="toggleCategory()">
     <span class="filter-title">Categories</span>
    <span class="toggle-icon">{{ isCategoryOpen ? '−' : '+' }}</span>
  </div>

  <div class="filter-content" *ngIf="isCategoryOpen">
    <!-- Category search input -->
    <div class="search-box">
      <input type="text" placeholder="Search categories..." [(ngModel)]="searchCategoryTerm"
             (input)="displayCount = 6">
               <svg class="search-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 30 30" fill="none">
    <path d="M25.8648 23.122L20.4231 17.6803C21.2439 16.3339 21.7162 14.7499 21.7162 13.0579C21.7162 8.1374 17.4523 3.875 12.5319 3.875C7.61138 3.875 3.62402 7.86236 3.62402 12.7828C3.62402 17.7019 7.88786 21.9657 12.8069 21.9657C14.4442 21.9657 15.9749 21.5208 17.2925 20.7504L22.7631 26.2238C23.2987 26.758 24.1671 26.758 24.7013 26.2238L26.0592 24.8659C26.5935 24.3316 26.3991 23.6563 25.8648 23.122ZM6.36578 12.7828C6.36578 9.3758 9.12626 6.61532 12.5319 6.61532C15.9375 6.61532 18.9744 9.6494 18.9744 13.0579C18.9744 16.4635 16.2125 19.2254 12.8069 19.2254C9.4013 19.2254 6.36578 16.1884 6.36578 12.7828Z" fill="#FA4C06"/>
  </svg>
    </div>

    <!-- Category list with scroll -->
    <div class="scrollable-list">
      <div class="checkbox-item" *ngFor="let category of filteredCategories">
        <input  class="condition-checkbox" type="checkbox" [id]="'category-' + category.id" [checked]="category.checked"
               (change)="category.checked = !category.checked; onCategoryChange()">
        <label [for]="'category-' + category.id">
          {{ category.name }} <span class="count">({{ category.listings_count}})</span>
        </label>
      </div>
    </div>

    <!-- Show more button -->
    <button class="show-more-btn" *ngIf="bikePartsCatg.length > displayCount" 
            (click)="showMoreCategories()">
      Show More Categories
    </button>
  </div>
</div>
<div class="filter-section">
  <div class="filter-header">
     <span class="filter-title">Price Range</span>
  </div>

  <div class="price-range">
    <div class="slider-container">
      <input type="range" [min]="absoluteMin" [max]="absoluteMax" [(ngModel)]="priceRange.min"
        (input)="onMinSliderChange($event)" class="slider">
      <input type="range" [min]="absoluteMin" [max]="absoluteMax" [(ngModel)]="priceRange.max"
        (input)="onMaxSliderChange($event)" class="slider">
    </div>

    <div class="price-inputs">
      <div class="price-input">
        <label>Min</label>
        <input type="number" [(ngModel)]="priceRange.min" [min]="absoluteMin" [max]="absoluteMax"
          (change)="onMinInputChange()">
      </div>
      <div class="price-input">
        <label>MAX</label>
        <input type="number" [(ngModel)]="priceRange.max" [min]="absoluteMin" [max]="absoluteMax"
          (change)="onMaxInputChange()">
      </div>
    </div>
  </div>
</div>
    </div>
    <!-- Main Content Area -->
    <div class="main-content">
      <!-- New Filter Card Section -->
      <!-- <div class="filter-card-container">
        <div class="filter-card">
          <div class="filter-card-header">
            <h3>Browse as you wish</h3>
            <div class="filter-tags">
              <span class="filter-tag">Model</span>
              <span class="filter-tag">Category</span>
            </div>
          </div>
          
          <div class="filter-controls">
            <div class="filter-select">
              <select>
                <option value="">Brand</option>
                <option *ngFor="let brand of brands" [value]="brand.id">{{ brand.name }}</option>
              </select>
              <span class="check-mark">✔</span>
            </div>
            
            <div class="filter-select">
              <select>
                <option value="">Model</option>
              </select>
              <span class="check-mark">✔</span>
            </div>
            
            <div class="filter-select">
              <select>
                <option value="">Year</option>
              </select>
              <span class="check-mark">✔</span>
            </div>
            
            <button class="search-btn">
              Search
            </button>
          </div>
        </div>
      </div> -->

         <div class="filter-card">
          <div class="browse-section">
            <h3>Browse as you wish</h3>
          </div>

          <!-- Tab Buttons - Updated -->
          <div class="tab-buttons">
            <button
              [class.active]="activeTab === 'model'"
              (click)="switchTab('model')"
              class="tab-button"
            >
              Model
            </button>
            <button
              [class.active]="activeTab === 'category'"
              (click)="switchTab('category')"
              class="tab-button"
            >
              Category
            </button>
          </div>


          <div *ngIf="activeTab === 'model'" class="button-group">
            <div class="filter-select">
              <select
                [(ngModel)]="selectedBrand"
                (ngModelChange)="onBrandChange($event)"
                class="brand-select"
              >
                <option value="">Brand</option>
                <option *ngFor="let brand of brands" [value]="brand.id">
                  {{ brand.name }}
                </option>
              </select>
            </div>

            <div class="filter-select">
              <select
                [(ngModel)]="selectedModel"
                (ngModelChange)="onModelChange($event)"
                class="model-select"
              >
                <option value="">Model</option>
                <option *ngFor="let model of filteredModels" [value]="model.id">
                  {{ model.name }}
                </option>
              </select>
            </div>

            <div class="filter-select">
              <select
                [(ngModel)]="selectedYear"
                (ngModelChange)="onYearChange($event)"
                class="year-select"
              >
                <option value="">Year</option>
                <option *ngFor="let year of filteredYears" [value]="year.id">
                  {{ year.year }}
                </option>
              </select>
            </div>
          </div>

          <!-- Category Tab Content - NEW -->
          <div *ngIf="activeTab === 'category'" class="category-content">
            <div class="category-grid">
              <div
                *ngFor="let category of categories"
                [class.selected]="category.selected"
                (click)="selectCategory(category.id)"
                class="category-item"
              >
                <div class="category-placeholder"></div>
                <span class="category-name">{{ category.name }}</span>
                <span *ngIf="category.selected" class="category-checkmark"
                  >✔</span
                >
              </div>
            </div>
            <!-- <button
              class="search-button category-search-btn"
              (click)="onSearch()"
            >
              Search
            </button> -->
          </div>
        </div>
    <!-- Side Bar End -->
     <!-- <div *ngIf="spareParts?.length !== 0">
    <div class="products-grid">
      <div *ngFor="let part of spareParts" class="product-card">
        <div class="product-image">
          <img [src]="part.image" [alt]="part.title" class="w-full h-full object-cover" />
        </div>

        <div class="product-content">
          <h3 class="product-title" [title]="part.title">
            {{ truncateText(part.title, 20) }}
          </h3>

          <p *ngIf="part.description" class="product-description" [title]="part.description">
            {{ truncateText(part.description, 30) }}
          </p>

          <div class="product-footer">
            <p class="price-label">PRICE</p>
            <p class="price-value">{{ part.price }} SAR</p>
             <button class="view-button" (click)="viewListing(part.id)">
          View Bike Part
        </button>
          </div>
        </div>
      </div>
    </div>
    </div> -->

    <!-- products-grid -->
   <div
          *ngIf="!isLoading && spareParts?.length > 0"
          class="main-cards"
          [class.opacity-100]="!isLoading && spareParts?.length > 0"
          [class.translate-y-0]="!isLoading && spareParts?.length > 0"
        >
          <div
            *ngFor="
              let part of spareParts;
              trackBy: trackBySparePartsId;
              let i = index
            "
            class="cards"
            [style.animation-delay]="i * 100 + 'ms'"
            [class.animate-fade-in-up]="!isLoading"
          >
            <!-- Image with Loading State -->
            <div class="product-image relative overflow-hidden">
              <img
                [src]="part.image"
                [alt]="part.title"
                class="w-full h-full object-cover transition-transform duration-300 hover:scale-105"
                (load)="onImageLoad($event)"
                (error)="onImageError($event)"
              />
            </div>

            <!-- Content -->
            <div class="product-content">
              <!-- Title -->
              <span class="product-title" [title]="part.title">
                {{ truncateText(part.title, 20) }}
              </span>
<!-- 
              <span class="product-brand">
                {{ part.brand }} {{ part.model }} {{ part.year }}
              </span> -->

              <span class="price-value">{{ part.price }} SAR</span>

       
              <!-- Price and Button -->
              <div class="product-footer">
                <button class="viewBtn" (click)="viewListing(part.id)">
                  View Bike
                </button>
              </div>
            </div>
          </div>
        </div>
    <!-- products-grid -->

<!-- <div *ngIf="spareParts?.length === 0" class="flex flex-col items-center justify-center py-12 px-4 text-center">
  <div class="max-w-md mx-auto">
    <h3 class="text-xl font-medium text-gray-800 mb-2">No vehicles found</h3>
    <p class="text-gray-600 mb-6">
      We couldn't find any vehicle that matches your filter, change or clear filters
    </p>
    <button 
      
      class="px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors"
    >
      Clear Filter
    </button>
  </div>
</div> -->
  </div>
</div>



      <!-- <div class="filter-section">
        <div class="filter-header" (click)="toggleDigits()">
          <span>Shop By</span>
          <span class="toggle-icon">{{ isDigitsOpen ? '−' : '+' }}</span>
        </div>

        <div class="filter-content" *ngIf="isDigitsOpen">
          <div class="checkbox-item" *ngFor="let digit of digits">
            <input type="checkbox" [id]="'digit-' + digit.value" [checked]="digit.checked"
              (change)="digit.checked = !digit.checked">
            <label [for]="'digit-' + digit.value">{{ digit.value }} <span class="count">({{ digit.count
                }})</span></label>
          </div>
        </div>
      </div>

      <div class="filter-section">
        <div class="filter-header" (click)="toggleCountry()">
          <span>Country</span>
          <span class="toggle-icon">{{ isCountryOpen ? '−' : '+' }}</span>
        </div>

        <div class="filter-content" *ngIf="isCountryOpen">
          <div class="checkbox-item" *ngFor="let country of countries">
            <input type="checkbox" [id]="'country-' + country.code" [checked]="country.checked"
              (change)="country.checked = !country.checked">
            <label [for]="'country-' + country.code">{{ country.name }} <span class="count">({{ country.count
                }})</span></label>
          </div>
        </div>
      </div>

      <div class="filter-section">
        <div class="filter-header" (click)="togglePlateCode()">
          <span>Plate Code</span>
          <span class="toggle-icon">{{ isPlateCodeOpen ? '−' : '+' }}</span>
        </div>

        <div class="filter-content" *ngIf="isPlateCodeOpen">
          <div class="checkbox-item" *ngFor="let code of plateCodes">
            <input type="checkbox" [id]="'code-' + code.value" [checked]="code.checked"
              (change)="code.checked = !code.checked">
            <label [for]="'code-' + code.value">{{ code.value }} <span class="count">({{ code.count }})</span></label>
          </div>
        </div>
      </div>

      <div class="filter-section">
        <div class="filter-header">
          <span>Price Range</span>
        </div>

        <div class="price-range">
          <div class="slider-container">
            <input type="range" min="0" max="1000" [(ngModel)]="priceRange.min" (input)="onMinSliderChange($event)"
              class="slider">
            <input type="range" min="0" max="1000" [(ngModel)]="priceRange.max" (input)="onMaxSliderChange($event)"
              class="slider">
          </div>

          <div class="price-inputs">
            <div class="price-input">
              <label>Min</label>
              <input type="number" [(ngModel)]="priceRange.min" min="0" max="1000" (change)="onMinInputChange()">
            </div>
            <div class="price-input">
              <label>MAX</label>
              <input type="number" [(ngModel)]="priceRange.max" min="0" max="1000" (change)="onMaxInputChange()">
            </div>
          </div>
        </div>
      </div> -->

      <!-- <div class="filter-section">
        <div class="filter-header" (click)="toggleDigits()">
          <span>Condition</span>
          <span class="toggle-icon">{{ isDigitsOpen ? '−' : '+' }}</span>
        </div>

        <div class="filter-content" *ngIf="isDigitsOpen">
          <div class="checkbox-item">
            <input type="radio" id="condition-all" name="condition" [checked]="!selectedCondition"
              (change)="selectedCondition = '';">
            <label for="condition-all">All Conditions</label>
          </div>
          <div class="checkbox-item">
            <input type="radio" id="condition-new" name="condition" value="new" [checked]="selectedCondition === 'new'"
              (change)="selectedCondition = 'new';">
            <label for="condition-new">New</label>
          </div>
          <div class="checkbox-item">
            <input type="radio" id="condition-used" name="condition" value="used"
              [checked]="selectedCondition === 'used'" (change)="selectedCondition = 'used';">
            <label for="condition-used">Used</label>
          </div>
        </div>
      </div>

      <div class="filter-section">
        <div class="filter-header" (click)="toggleCountry()">
          <span>Brand</span>
          <span class="toggle-icon">{{ isCountryOpen ? '−' : '+' }}</span>
        </div>

        <div class="filter-content" *ngIf="isCountryOpen">
          <div class="checkbox-item" *ngFor="let brand of brands">
            <input type="checkbox" [id]="'brand-' + brand.id" [checked]="brand.checked"
              (change)="brand.checked = !brand.checked; onBrandChange()">
            <label [for]="'brand-' + brand.id">
              {{ brand.name }} <span class="count">({{ brand.listings_count}})</span>
            </label>
          </div>
        </div>
      </div>



      <div class="filter-section">
        <div class="filter-header">
          <span>Price Range</span>
        </div>

        <div class="price-range">
          <div class="slider-container">
            <input type="range" [min]="absoluteMin" [max]="absoluteMax" [(ngModel)]="priceRange.min"
              (input)="onMinSliderChange($event)" class="slider">
            <input type="range" [min]="absoluteMin" [max]="absoluteMax" [(ngModel)]="priceRange.max"
              (input)="onMaxSliderChange($event)" class="slider">
          </div>

          <div class="price-inputs">
            <div class="price-input">
              <label>Min</label>
              <input type="number" [(ngModel)]="priceRange.min" [min]="absoluteMin" [max]="absoluteMax"
                (change)="onMinInputChange()">
            </div>
            <div class="price-input">
              <label>MAX</label>
              <input type="number" [(ngModel)]="priceRange.max" [min]="absoluteMin" [max]="absoluteMax"
                (change)="onMaxInputChange()">
            </div>
          </div>
        </div>
      </div> -->
    <!-- <div class="filter-section">
  <div class="filter-header" (click)="toggleCountry()">
    <span>Brand</span>
    <span class="toggle-icon">{{ isCountryOpen ? '−' : '+' }}</span>
  </div>

  <div class="filter-content" *ngIf="isCountryOpen">
    <div class="checkbox-item" *ngFor="let brand of bikePartsBrand">
      <input type="checkbox" [id]="'brand-' + brand.id" [checked]="brand.checked"
        (change)="brand.checked = !brand.checked; onBrandChange()">
      <label [for]="'brand-' + brand.id">
        {{ brand.name }} <span class="count">({{ brand.listings_count}})</span>
      </label>
    </div>
  </div>
</div>

<div class="filter-section">
  <div class="filter-header" (click)="toggleCategory()">
    <span>Categories</span>
    <span class="toggle-icon">{{ isCategoryOpen ? '−' : '+' }}</span>
  </div>

  <div class="filter-content" *ngIf="isCategoryOpen">
    <div class="checkbox-item" *ngFor="let category of bikePartsCatg">
      <input type="checkbox" [id]="'category-' + category.id" [checked]="category.checked"
        (change)="category.checked = !category.checked; onCategoryChange()">
      <label [for]="'category-' + category.id">
        {{ category.name }} <span class="count">({{ category.listings_count}})</span>
      </label>
    </div>
  </div>
</div> -->